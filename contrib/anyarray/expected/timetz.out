SELECT
    t,
	ARRAY(
		SELECT
			epoch2timestamp(v)::timestamptz::timetz
		FROM
			generate_series(max(0, t - 10),  t) as v
	) AS v
	INTO test_timetz
FROM
	generate_series(1, 200) as t;
SET anyarray.similarity_type=cosine;
SELECT  t, similarity(v, to_tsp_array('{10,9,8,7,6,5,4,3,2,1}')::timestamptz[]::timetz[]) AS s FROM test_timetz 
	WHERE v % to_tsp_array('{10,9,8,7,6,5,4,3,2,1}')::timestamptz[]::timetz[] ORDER BY s DESC, t;
 t  |    s     
----+----------
 10 | 0.953463
 11 | 0.953463
  9 |      0.9
 12 | 0.858116
  8 | 0.843274
  7 | 0.782624
 13 |  0.76277
  6 | 0.717137
 14 | 0.667424
  5 | 0.645497
(10 rows)

SELECT  t, similarity(v, to_tsp_array('{50,49,8,7,6,5,4,3,2,1}')::timestamptz[]::timetz[]) AS s FROM test_timetz 
	WHERE v % to_tsp_array('{50,49,8,7,6,5,4,3,2,1}')::timestamptz[]::timetz[] ORDER BY s DESC, t;
 t  |    s     
----+----------
  8 | 0.843274
  9 |      0.8
  7 | 0.782624
 10 |  0.76277
 11 |  0.76277
  6 | 0.717137
 12 | 0.667424
  5 | 0.645497
(8 rows)

SET anyarray.similarity_type=jaccard;
SELECT  t, similarity(v, to_tsp_array('{10,9,8,7,6,5,4,3,2,1}')::timestamptz[]::timetz[]) AS s FROM test_timetz 
	WHERE v % to_tsp_array('{10,9,8,7,6,5,4,3,2,1}')::timestamptz[]::timetz[] ORDER BY s DESC, t;
 t  |    s     
----+----------
 10 | 0.909091
 11 | 0.909091
  9 | 0.818182
 12 |     0.75
  8 | 0.727273
  7 | 0.636364
 13 | 0.615385
(7 rows)

SELECT  t, similarity(v, to_tsp_array('{50,49,8,7,6,5,4,3,2,1}')::timestamptz[]::timetz[]) AS s FROM test_timetz 
	WHERE v % to_tsp_array('{50,49,8,7,6,5,4,3,2,1}')::timestamptz[]::timetz[] ORDER BY s DESC, t;
 t  |    s     
----+----------
  8 | 0.727273
  9 | 0.666667
  7 | 0.636364
 10 | 0.615385
 11 | 0.615385
(5 rows)

SELECT t, v FROM test_timetz WHERE v && to_tsp_array('{43,50}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
 43 | {00:00:33-08,00:00:34-08,00:00:35-08,00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08}
 44 | {00:00:34-08,00:00:35-08,00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08}
 45 | {00:00:35-08,00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08}
 46 | {00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08}
 47 | {00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08}
 48 | {00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08}
 49 | {00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08}
 50 | {00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08}
 51 | {00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08}
 52 | {00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08}
 53 | {00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08}
 54 | {00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08}
 55 | {00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08}
 56 | {00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08}
 57 | {00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08}
 58 | {00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08,00:00:58-08}
 59 | {00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08,00:00:58-08,00:00:59-08}
 60 | {00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08,00:00:58-08,00:00:59-08,00:01:00-08}
(18 rows)

SELECT t, v FROM test_timetz WHERE v @> to_tsp_array('{43,50}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
 50 | {00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08}
 51 | {00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08}
 52 | {00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08}
 53 | {00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08}
(4 rows)

SELECT t, v FROM test_timetz WHERE v <@ to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  1 | {00:00:00-08,00:00:01-08}
  2 | {00:00:00-08,00:00:01-08,00:00:02-08}
  3 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08}
  4 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08}
  5 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08}
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
(10 rows)

SELECT t, v FROM test_timetz WHERE v =  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
(1 row)

SET anyarray.similarity_type=cosine;
SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  3 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08}
  4 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08}
  5 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08}
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
 11 | {00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08}
 12 | {00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08}
 13 | {00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08}
 14 | {00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08}
(12 rows)

SET anyarray.similarity_type=jaccard;
SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
 11 | {00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08}
 12 | {00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08}
(7 rows)

SET anyarray.similarity_type=overlap;
SET anyarray.similarity_threshold = 3;
SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  2 | {00:00:00-08,00:00:01-08,00:00:02-08}
  3 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08}
  4 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08}
  5 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08}
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
 11 | {00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08}
 12 | {00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08}
 13 | {00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08}
 14 | {00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08}
 15 | {00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08}
 16 | {00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08,00:00:16-08}
 17 | {00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08,00:00:16-08,00:00:17-08}
 18 | {00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08,00:00:16-08,00:00:17-08,00:00:18-08}
(17 rows)

RESET anyarray.similarity_threshold;
CREATE INDEX idx_test_timetz ON test_timetz USING gist (v _timetz_aa_ops);
SET enable_seqscan=off;
EXPLAIN (COSTS OFF) SELECT t, v FROM test_timetz WHERE v && to_tsp_array('{43,50}')::timestamptz[]::timetz[] ORDER BY t;
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_timetz
         Recheck Cond: (v && (('{"Fri Feb 13 00:00:43 1970","Fri Feb 20 00:00:50 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
         ->  Bitmap Index Scan on idx_test_timetz
               Index Cond: (v && (('{"Fri Feb 13 00:00:43 1970","Fri Feb 20 00:00:50 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_timetz WHERE v @> to_tsp_array('{43,50}')::timestamptz[]::timetz[] ORDER BY t;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_timetz on test_timetz
         Index Cond: (v @> (('{"Fri Feb 13 00:00:43 1970","Fri Feb 20 00:00:50 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
(4 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_timetz WHERE v <@ to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_timetz on test_timetz
         Index Cond: (v <@ (('{"Thu Jan 01 00:00:00 1970","Fri Jan 02 00:00:01 1970","Sat Jan 03 00:00:02 1970","Sun Jan 04 00:00:03 1970","Mon Jan 05 00:00:04 1970","Tue Jan 06 00:00:05 1970","Wed Jan 07 00:00:06 1970","Thu Jan 08 00:00:07 1970","Fri Jan 09 00:00:08 1970","Sat Jan 10 00:00:09 1970","Sun Jan 11 00:00:10 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
(4 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_timetz WHERE v =  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_timetz on test_timetz
         Index Cond: (v = (('{"Thu Jan 01 00:00:00 1970","Fri Jan 02 00:00:01 1970","Sat Jan 03 00:00:02 1970","Sun Jan 04 00:00:03 1970","Mon Jan 05 00:00:04 1970","Tue Jan 06 00:00:05 1970","Wed Jan 07 00:00:06 1970","Thu Jan 08 00:00:07 1970","Fri Jan 09 00:00:08 1970","Sat Jan 10 00:00:09 1970","Sun Jan 11 00:00:10 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
(4 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_timetz on test_timetz
         Index Cond: (v % (('{"Thu Jan 01 00:00:00 1970","Fri Jan 02 00:00:01 1970","Sat Jan 03 00:00:02 1970","Sun Jan 04 00:00:03 1970","Mon Jan 05 00:00:04 1970","Tue Jan 06 00:00:05 1970","Wed Jan 07 00:00:06 1970","Thu Jan 08 00:00:07 1970","Fri Jan 09 00:00:08 1970","Sat Jan 10 00:00:09 1970","Sun Jan 11 00:00:10 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
(4 rows)

SELECT t, v FROM test_timetz WHERE v && to_tsp_array('{43,50}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
 43 | {00:00:33-08,00:00:34-08,00:00:35-08,00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08}
 44 | {00:00:34-08,00:00:35-08,00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08}
 45 | {00:00:35-08,00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08}
 46 | {00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08}
 47 | {00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08}
 48 | {00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08}
 49 | {00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08}
 50 | {00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08}
 51 | {00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08}
 52 | {00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08}
 53 | {00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08}
 54 | {00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08}
 55 | {00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08}
 56 | {00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08}
 57 | {00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08}
 58 | {00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08,00:00:58-08}
 59 | {00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08,00:00:58-08,00:00:59-08}
 60 | {00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08,00:00:58-08,00:00:59-08,00:01:00-08}
(18 rows)

SELECT t, v FROM test_timetz WHERE v @> to_tsp_array('{43,50}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
 50 | {00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08}
 51 | {00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08}
 52 | {00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08}
 53 | {00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08}
(4 rows)

SELECT t, v FROM test_timetz WHERE v <@ to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  1 | {00:00:00-08,00:00:01-08}
  2 | {00:00:00-08,00:00:01-08,00:00:02-08}
  3 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08}
  4 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08}
  5 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08}
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
(10 rows)

SELECT t, v FROM test_timetz WHERE v =  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
(1 row)

SET anyarray.similarity_type=cosine;
SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  3 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08}
  4 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08}
  5 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08}
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
 11 | {00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08}
 12 | {00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08}
 13 | {00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08}
 14 | {00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08}
(12 rows)

SET anyarray.similarity_type=jaccard;
SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
 11 | {00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08}
 12 | {00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08}
(7 rows)

SET anyarray.similarity_type=overlap;
SET anyarray.similarity_threshold = 3;
SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  2 | {00:00:00-08,00:00:01-08,00:00:02-08}
  3 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08}
  4 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08}
  5 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08}
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
 11 | {00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08}
 12 | {00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08}
 13 | {00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08}
 14 | {00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08}
 15 | {00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08}
 16 | {00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08,00:00:16-08}
 17 | {00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08,00:00:16-08,00:00:17-08}
 18 | {00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08,00:00:16-08,00:00:17-08,00:00:18-08}
(17 rows)

RESET anyarray.similarity_threshold;
DROP INDEX idx_test_timetz;
CREATE INDEX idx_test_timetz ON test_timetz USING gin (v _timetz_aa_ops);
SET enable_seqscan=off;
EXPLAIN (COSTS OFF) SELECT t, v FROM test_timetz WHERE v && to_tsp_array('{43,50}')::timestamptz[]::timetz[] ORDER BY t;
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_timetz
         Recheck Cond: (v && (('{"Fri Feb 13 00:00:43 1970","Fri Feb 20 00:00:50 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
         ->  Bitmap Index Scan on idx_test_timetz
               Index Cond: (v && (('{"Fri Feb 13 00:00:43 1970","Fri Feb 20 00:00:50 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_timetz WHERE v @> to_tsp_array('{43,50}')::timestamptz[]::timetz[] ORDER BY t;
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_timetz
         Recheck Cond: (v @> (('{"Fri Feb 13 00:00:43 1970","Fri Feb 20 00:00:50 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
         ->  Bitmap Index Scan on idx_test_timetz
               Index Cond: (v @> (('{"Fri Feb 13 00:00:43 1970","Fri Feb 20 00:00:50 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_timetz WHERE v <@ to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
                                                                                                                                                                                                             QUERY PLAN                                                                                                                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_timetz
         Recheck Cond: (v <@ (('{"Thu Jan 01 00:00:00 1970","Fri Jan 02 00:00:01 1970","Sat Jan 03 00:00:02 1970","Sun Jan 04 00:00:03 1970","Mon Jan 05 00:00:04 1970","Tue Jan 06 00:00:05 1970","Wed Jan 07 00:00:06 1970","Thu Jan 08 00:00:07 1970","Fri Jan 09 00:00:08 1970","Sat Jan 10 00:00:09 1970","Sun Jan 11 00:00:10 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
         ->  Bitmap Index Scan on idx_test_timetz
               Index Cond: (v <@ (('{"Thu Jan 01 00:00:00 1970","Fri Jan 02 00:00:01 1970","Sat Jan 03 00:00:02 1970","Sun Jan 04 00:00:03 1970","Mon Jan 05 00:00:04 1970","Tue Jan 06 00:00:05 1970","Wed Jan 07 00:00:06 1970","Thu Jan 08 00:00:07 1970","Fri Jan 09 00:00:08 1970","Sat Jan 10 00:00:09 1970","Sun Jan 11 00:00:10 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_timetz WHERE v =  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
                                                                                                                                                                                                             QUERY PLAN                                                                                                                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_timetz
         Recheck Cond: (v = (('{"Thu Jan 01 00:00:00 1970","Fri Jan 02 00:00:01 1970","Sat Jan 03 00:00:02 1970","Sun Jan 04 00:00:03 1970","Mon Jan 05 00:00:04 1970","Tue Jan 06 00:00:05 1970","Wed Jan 07 00:00:06 1970","Thu Jan 08 00:00:07 1970","Fri Jan 09 00:00:08 1970","Sat Jan 10 00:00:09 1970","Sun Jan 11 00:00:10 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
         ->  Bitmap Index Scan on idx_test_timetz
               Index Cond: (v = (('{"Thu Jan 01 00:00:00 1970","Fri Jan 02 00:00:01 1970","Sat Jan 03 00:00:02 1970","Sun Jan 04 00:00:03 1970","Mon Jan 05 00:00:04 1970","Tue Jan 06 00:00:05 1970","Wed Jan 07 00:00:06 1970","Thu Jan 08 00:00:07 1970","Fri Jan 09 00:00:08 1970","Sat Jan 10 00:00:09 1970","Sun Jan 11 00:00:10 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
                                                                                                                                                                                                             QUERY PLAN                                                                                                                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_timetz
         Recheck Cond: (v % (('{"Thu Jan 01 00:00:00 1970","Fri Jan 02 00:00:01 1970","Sat Jan 03 00:00:02 1970","Sun Jan 04 00:00:03 1970","Mon Jan 05 00:00:04 1970","Tue Jan 06 00:00:05 1970","Wed Jan 07 00:00:06 1970","Thu Jan 08 00:00:07 1970","Fri Jan 09 00:00:08 1970","Sat Jan 10 00:00:09 1970","Sun Jan 11 00:00:10 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
         ->  Bitmap Index Scan on idx_test_timetz
               Index Cond: (v % (('{"Thu Jan 01 00:00:00 1970","Fri Jan 02 00:00:01 1970","Sat Jan 03 00:00:02 1970","Sun Jan 04 00:00:03 1970","Mon Jan 05 00:00:04 1970","Tue Jan 06 00:00:05 1970","Wed Jan 07 00:00:06 1970","Thu Jan 08 00:00:07 1970","Fri Jan 09 00:00:08 1970","Sat Jan 10 00:00:09 1970","Sun Jan 11 00:00:10 1970"}'::timestamp without time zone[])::timestamp with time zone[])::time with time zone[])
(6 rows)

SELECT t, v FROM test_timetz WHERE v && to_tsp_array('{43,50}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
 43 | {00:00:33-08,00:00:34-08,00:00:35-08,00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08}
 44 | {00:00:34-08,00:00:35-08,00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08}
 45 | {00:00:35-08,00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08}
 46 | {00:00:36-08,00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08}
 47 | {00:00:37-08,00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08}
 48 | {00:00:38-08,00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08}
 49 | {00:00:39-08,00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08}
 50 | {00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08}
 51 | {00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08}
 52 | {00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08}
 53 | {00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08}
 54 | {00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08}
 55 | {00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08}
 56 | {00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08}
 57 | {00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08}
 58 | {00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08,00:00:58-08}
 59 | {00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08,00:00:58-08,00:00:59-08}
 60 | {00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08,00:00:54-08,00:00:55-08,00:00:56-08,00:00:57-08,00:00:58-08,00:00:59-08,00:01:00-08}
(18 rows)

SELECT t, v FROM test_timetz WHERE v @> to_tsp_array('{43,50}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
 50 | {00:00:40-08,00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08}
 51 | {00:00:41-08,00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08}
 52 | {00:00:42-08,00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08}
 53 | {00:00:43-08,00:00:44-08,00:00:45-08,00:00:46-08,00:00:47-08,00:00:48-08,00:00:49-08,00:00:50-08,00:00:51-08,00:00:52-08,00:00:53-08}
(4 rows)

SELECT t, v FROM test_timetz WHERE v <@ to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  1 | {00:00:00-08,00:00:01-08}
  2 | {00:00:00-08,00:00:01-08,00:00:02-08}
  3 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08}
  4 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08}
  5 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08}
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
(10 rows)

SELECT t, v FROM test_timetz WHERE v =  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
(1 row)

SET anyarray.similarity_type=cosine;
SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  3 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08}
  4 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08}
  5 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08}
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
 11 | {00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08}
 12 | {00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08}
 13 | {00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08}
 14 | {00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08}
(12 rows)

SET anyarray.similarity_type=jaccard;
SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
 11 | {00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08}
 12 | {00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08}
(7 rows)

SET anyarray.similarity_type=overlap;
SET anyarray.similarity_threshold = 3;
SELECT t, v FROM test_timetz WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::timestamptz[]::timetz[] ORDER BY t;
 t  |                                                                   v                                                                   
----+---------------------------------------------------------------------------------------------------------------------------------------
  2 | {00:00:00-08,00:00:01-08,00:00:02-08}
  3 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08}
  4 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08}
  5 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08}
  6 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08}
  7 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08}
  8 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08}
  9 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08}
 10 | {00:00:00-08,00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08}
 11 | {00:00:01-08,00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08}
 12 | {00:00:02-08,00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08}
 13 | {00:00:03-08,00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08}
 14 | {00:00:04-08,00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08}
 15 | {00:00:05-08,00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08}
 16 | {00:00:06-08,00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08,00:00:16-08}
 17 | {00:00:07-08,00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08,00:00:16-08,00:00:17-08}
 18 | {00:00:08-08,00:00:09-08,00:00:10-08,00:00:11-08,00:00:12-08,00:00:13-08,00:00:14-08,00:00:15-08,00:00:16-08,00:00:17-08,00:00:18-08}
(17 rows)

RESET anyarray.similarity_threshold;
