SELECT
    t,
	ARRAY(
		SELECT
			epoch2timestamp(v)::date
		FROM
			generate_series(max(0, t - 10),  t) as v
	) AS v
	INTO test_date
FROM
	generate_series(1, 200) as t;
SET anyarray.similarity_type=cosine;
SELECT  t, similarity(v, to_tsp_array('{10,9,8,7,6,5,4,3,2,1}')::date[]) AS s FROM test_date 
	WHERE v % to_tsp_array('{10,9,8,7,6,5,4,3,2,1}')::date[] ORDER BY s DESC, t;
 t  |    s     
----+----------
 10 | 0.953463
 11 | 0.953463
  9 |      0.9
 12 | 0.858116
  8 | 0.843274
  7 | 0.782624
 13 |  0.76277
  6 | 0.717137
 14 | 0.667424
  5 | 0.645497
(10 rows)

SELECT  t, similarity(v, to_tsp_array('{50,49,8,7,6,5,4,3,2,1}')::date[]) AS s FROM test_date 
	WHERE v % to_tsp_array('{50,49,8,7,6,5,4,3,2,1}')::date[] ORDER BY s DESC, t;
 t  |    s     
----+----------
  8 | 0.843274
  9 |      0.8
  7 | 0.782624
 10 |  0.76277
 11 |  0.76277
  6 | 0.717137
 12 | 0.667424
  5 | 0.645497
(8 rows)

SET anyarray.similarity_type=jaccard;
SELECT  t, similarity(v, to_tsp_array('{10,9,8,7,6,5,4,3,2,1}')::date[]) AS s FROM test_date 
	WHERE v % to_tsp_array('{10,9,8,7,6,5,4,3,2,1}')::date[] ORDER BY s DESC, t;
 t  |    s     
----+----------
 10 | 0.909091
 11 | 0.909091
  9 | 0.818182
 12 |     0.75
  8 | 0.727273
  7 | 0.636364
 13 | 0.615385
(7 rows)

SELECT  t, similarity(v, to_tsp_array('{50,49,8,7,6,5,4,3,2,1}')::date[]) AS s FROM test_date 
	WHERE v % to_tsp_array('{50,49,8,7,6,5,4,3,2,1}')::date[] ORDER BY s DESC, t;
 t  |    s     
----+----------
  8 | 0.727273
  9 | 0.666667
  7 | 0.636364
 10 | 0.615385
 11 | 0.615385
(5 rows)

SELECT t, v FROM test_date WHERE v && to_tsp_array('{43,50}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
 43 | {02-03-1970,02-04-1970,02-05-1970,02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970}
 44 | {02-04-1970,02-05-1970,02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970}
 45 | {02-05-1970,02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970}
 46 | {02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970}
 47 | {02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970}
 48 | {02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970}
 49 | {02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970}
 50 | {02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970}
 51 | {02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970}
 52 | {02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970}
 53 | {02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970}
 54 | {02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970}
 55 | {02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970}
 56 | {02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970}
 57 | {02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970}
 58 | {02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970,02-28-1970}
 59 | {02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970,02-28-1970,03-01-1970}
 60 | {02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970,02-28-1970,03-01-1970,03-02-1970}
(18 rows)

SELECT t, v FROM test_date WHERE v @> to_tsp_array('{43,50}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
 50 | {02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970}
 51 | {02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970}
 52 | {02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970}
 53 | {02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970}
(4 rows)

SELECT t, v FROM test_date WHERE v <@ to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  1 | {01-01-1970,01-02-1970}
  2 | {01-01-1970,01-02-1970,01-03-1970}
  3 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970}
  4 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970}
  5 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970}
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
(10 rows)

SELECT t, v FROM test_date WHERE v =  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
(1 row)

SET anyarray.similarity_type=cosine;
SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  3 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970}
  4 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970}
  5 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970}
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
 11 | {01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970}
 12 | {01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970}
 13 | {01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970}
 14 | {01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970}
(12 rows)

SET anyarray.similarity_type=jaccard;
SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
 11 | {01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970}
 12 | {01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970}
(7 rows)

SET anyarray.similarity_type=overlap;
SET anyarray.similarity_threshold = 3;
SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  2 | {01-01-1970,01-02-1970,01-03-1970}
  3 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970}
  4 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970}
  5 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970}
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
 11 | {01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970}
 12 | {01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970}
 13 | {01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970}
 14 | {01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970}
 15 | {01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970}
 16 | {01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970,01-17-1970}
 17 | {01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970,01-17-1970,01-18-1970}
 18 | {01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970,01-17-1970,01-18-1970,01-19-1970}
(17 rows)

RESET anyarray.similarity_threshold;
CREATE INDEX idx_test_date ON test_date USING gist (v _date_aa_ops);
SET enable_seqscan=off;
EXPLAIN (COSTS OFF) SELECT t, v FROM test_date WHERE v && to_tsp_array('{43,50}')::date[] ORDER BY t;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_date
         Recheck Cond: (v && '{02-13-1970,02-20-1970}'::date[])
         ->  Bitmap Index Scan on idx_test_date
               Index Cond: (v && '{02-13-1970,02-20-1970}'::date[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_date WHERE v @> to_tsp_array('{43,50}')::date[] ORDER BY t;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_date on test_date
         Index Cond: (v @> '{02-13-1970,02-20-1970}'::date[])
(4 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_date WHERE v <@ to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_date on test_date
         Index Cond: (v <@ '{01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}'::date[])
(4 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_date WHERE v =  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
                                                                           QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_date on test_date
         Index Cond: (v = '{01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}'::date[])
(4 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
                                                                           QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_date on test_date
         Index Cond: (v % '{01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}'::date[])
(4 rows)

SELECT t, v FROM test_date WHERE v && to_tsp_array('{43,50}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
 43 | {02-03-1970,02-04-1970,02-05-1970,02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970}
 44 | {02-04-1970,02-05-1970,02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970}
 45 | {02-05-1970,02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970}
 46 | {02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970}
 47 | {02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970}
 48 | {02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970}
 49 | {02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970}
 50 | {02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970}
 51 | {02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970}
 52 | {02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970}
 53 | {02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970}
 54 | {02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970}
 55 | {02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970}
 56 | {02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970}
 57 | {02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970}
 58 | {02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970,02-28-1970}
 59 | {02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970,02-28-1970,03-01-1970}
 60 | {02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970,02-28-1970,03-01-1970,03-02-1970}
(18 rows)

SELECT t, v FROM test_date WHERE v @> to_tsp_array('{43,50}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
 50 | {02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970}
 51 | {02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970}
 52 | {02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970}
 53 | {02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970}
(4 rows)

SELECT t, v FROM test_date WHERE v <@ to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  1 | {01-01-1970,01-02-1970}
  2 | {01-01-1970,01-02-1970,01-03-1970}
  3 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970}
  4 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970}
  5 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970}
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
(10 rows)

SELECT t, v FROM test_date WHERE v =  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
(1 row)

SET anyarray.similarity_type=cosine;
SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  3 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970}
  4 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970}
  5 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970}
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
 11 | {01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970}
 12 | {01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970}
 13 | {01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970}
 14 | {01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970}
(12 rows)

SET anyarray.similarity_type=jaccard;
SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
 11 | {01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970}
 12 | {01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970}
(7 rows)

SET anyarray.similarity_type=overlap;
SET anyarray.similarity_threshold = 3;
SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  2 | {01-01-1970,01-02-1970,01-03-1970}
  3 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970}
  4 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970}
  5 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970}
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
 11 | {01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970}
 12 | {01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970}
 13 | {01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970}
 14 | {01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970}
 15 | {01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970}
 16 | {01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970,01-17-1970}
 17 | {01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970,01-17-1970,01-18-1970}
 18 | {01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970,01-17-1970,01-18-1970,01-19-1970}
(17 rows)

RESET anyarray.similarity_threshold;
DROP INDEX idx_test_date;
CREATE INDEX idx_test_date ON test_date USING gin (v _date_aa_ops);
SET enable_seqscan=off;
EXPLAIN (COSTS OFF) SELECT t, v FROM test_date WHERE v && to_tsp_array('{43,50}')::date[] ORDER BY t;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_date
         Recheck Cond: (v && '{02-13-1970,02-20-1970}'::date[])
         ->  Bitmap Index Scan on idx_test_date
               Index Cond: (v && '{02-13-1970,02-20-1970}'::date[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_date WHERE v @> to_tsp_array('{43,50}')::date[] ORDER BY t;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_date
         Recheck Cond: (v @> '{02-13-1970,02-20-1970}'::date[])
         ->  Bitmap Index Scan on idx_test_date
               Index Cond: (v @> '{02-13-1970,02-20-1970}'::date[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_date WHERE v <@ to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_date
         Recheck Cond: (v <@ '{01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}'::date[])
         ->  Bitmap Index Scan on idx_test_date
               Index Cond: (v <@ '{01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}'::date[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_date WHERE v =  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_date
         Recheck Cond: (v = '{01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}'::date[])
         ->  Bitmap Index Scan on idx_test_date
               Index Cond: (v = '{01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}'::date[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_date
         Recheck Cond: (v % '{01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}'::date[])
         ->  Bitmap Index Scan on idx_test_date
               Index Cond: (v % '{01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}'::date[])
(6 rows)

SELECT t, v FROM test_date WHERE v && to_tsp_array('{43,50}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
 43 | {02-03-1970,02-04-1970,02-05-1970,02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970}
 44 | {02-04-1970,02-05-1970,02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970}
 45 | {02-05-1970,02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970}
 46 | {02-06-1970,02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970}
 47 | {02-07-1970,02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970}
 48 | {02-08-1970,02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970}
 49 | {02-09-1970,02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970}
 50 | {02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970}
 51 | {02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970}
 52 | {02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970}
 53 | {02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970}
 54 | {02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970}
 55 | {02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970}
 56 | {02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970}
 57 | {02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970}
 58 | {02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970,02-28-1970}
 59 | {02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970,02-28-1970,03-01-1970}
 60 | {02-20-1970,02-21-1970,02-22-1970,02-23-1970,02-24-1970,02-25-1970,02-26-1970,02-27-1970,02-28-1970,03-01-1970,03-02-1970}
(18 rows)

SELECT t, v FROM test_date WHERE v @> to_tsp_array('{43,50}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
 50 | {02-10-1970,02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970}
 51 | {02-11-1970,02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970}
 52 | {02-12-1970,02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970}
 53 | {02-13-1970,02-14-1970,02-15-1970,02-16-1970,02-17-1970,02-18-1970,02-19-1970,02-20-1970,02-21-1970,02-22-1970,02-23-1970}
(4 rows)

SELECT t, v FROM test_date WHERE v <@ to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  1 | {01-01-1970,01-02-1970}
  2 | {01-01-1970,01-02-1970,01-03-1970}
  3 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970}
  4 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970}
  5 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970}
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
(10 rows)

SELECT t, v FROM test_date WHERE v =  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
(1 row)

SET anyarray.similarity_type=cosine;
SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  3 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970}
  4 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970}
  5 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970}
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
 11 | {01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970}
 12 | {01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970}
 13 | {01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970}
 14 | {01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970}
(12 rows)

SET anyarray.similarity_type=jaccard;
SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
 11 | {01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970}
 12 | {01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970}
(7 rows)

SET anyarray.similarity_type=overlap;
SET anyarray.similarity_threshold = 3;
SELECT t, v FROM test_date WHERE v %  to_tsp_array('{0,1,2,3,4,5,6,7,8,9,10}')::date[] ORDER BY t;
 t  |                                                             v                                                              
----+----------------------------------------------------------------------------------------------------------------------------
  2 | {01-01-1970,01-02-1970,01-03-1970}
  3 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970}
  4 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970}
  5 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970}
  6 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970}
  7 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970}
  8 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970}
  9 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970}
 10 | {01-01-1970,01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970}
 11 | {01-02-1970,01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970}
 12 | {01-03-1970,01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970}
 13 | {01-04-1970,01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970}
 14 | {01-05-1970,01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970}
 15 | {01-06-1970,01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970}
 16 | {01-07-1970,01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970,01-17-1970}
 17 | {01-08-1970,01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970,01-17-1970,01-18-1970}
 18 | {01-09-1970,01-10-1970,01-11-1970,01-12-1970,01-13-1970,01-14-1970,01-15-1970,01-16-1970,01-17-1970,01-18-1970,01-19-1970}
(17 rows)

RESET anyarray.similarity_threshold;
