SELECT
    t,
	ARRAY(
		SELECT
			v::text::bytea
		FROM
			generate_series(max(0, t - 10),  t) as v
	) AS v
	INTO test_bytea
FROM
	generate_series(1, 200) as t;
SET anyarray.similarity_type=cosine;
SELECT  t, similarity(v, '{10,9,8,7,6,5,4,3,2,1}') AS s FROM test_bytea 
	WHERE v % '{10,9,8,7,6,5,4,3,2,1}' ORDER BY s DESC, t;
 t  |    s     
----+----------
 10 | 0.953463
 11 | 0.953463
  9 |      0.9
 12 | 0.858116
  8 | 0.843274
  7 | 0.782624
 13 |  0.76277
  6 | 0.717137
 14 | 0.667424
  5 | 0.645497
(10 rows)

SELECT  t, similarity(v, '{50,49,8,7,6,5,4,3,2,1}') AS s FROM test_bytea 
	WHERE v % '{50,49,8,7,6,5,4,3,2,1}' ORDER BY s DESC, t;
 t  |    s     
----+----------
  8 | 0.843274
  9 |      0.8
  7 | 0.782624
 10 |  0.76277
 11 |  0.76277
  6 | 0.717137
 12 | 0.667424
  5 | 0.645497
(8 rows)

SET anyarray.similarity_type=jaccard;
SELECT  t, similarity(v, '{10,9,8,7,6,5,4,3,2,1}') AS s FROM test_bytea 
	WHERE v % '{10,9,8,7,6,5,4,3,2,1}' ORDER BY s DESC, t;
 t  |    s     
----+----------
 10 | 0.909091
 11 | 0.909091
  9 | 0.818182
 12 |     0.75
  8 | 0.727273
  7 | 0.636364
 13 | 0.615385
(7 rows)

SELECT  t, similarity(v, '{50,49,8,7,6,5,4,3,2,1}') AS s FROM test_bytea 
	WHERE v % '{50,49,8,7,6,5,4,3,2,1}' ORDER BY s DESC, t;
 t  |    s     
----+----------
  8 | 0.727273
  9 | 0.666667
  7 | 0.636364
 10 | 0.615385
 11 | 0.615385
(5 rows)

SELECT t, v FROM test_bytea WHERE v && '{43,50}' ORDER BY t;
 t  |                                                        v                                                        
----+-----------------------------------------------------------------------------------------------------------------
 43 | {"\\x3333","\\x3334","\\x3335","\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433"}
 44 | {"\\x3334","\\x3335","\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434"}
 45 | {"\\x3335","\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435"}
 46 | {"\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436"}
 47 | {"\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437"}
 48 | {"\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438"}
 49 | {"\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439"}
 50 | {"\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530"}
 51 | {"\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531"}
 52 | {"\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532"}
 53 | {"\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533"}
 54 | {"\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534"}
 55 | {"\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535"}
 56 | {"\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536"}
 57 | {"\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537"}
 58 | {"\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537","\\x3538"}
 59 | {"\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537","\\x3538","\\x3539"}
 60 | {"\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537","\\x3538","\\x3539","\\x3630"}
(18 rows)

SELECT t, v FROM test_bytea WHERE v @> '{43,50}' ORDER BY t;
 t  |                                                        v                                                        
----+-----------------------------------------------------------------------------------------------------------------
 50 | {"\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530"}
 51 | {"\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531"}
 52 | {"\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532"}
 53 | {"\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533"}
(4 rows)

SELECT t, v FROM test_bytea WHERE v <@ '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                              v                                              
----+---------------------------------------------------------------------------------------------
  1 | {"\\x30","\\x31"}
  2 | {"\\x30","\\x31","\\x32"}
  3 | {"\\x30","\\x31","\\x32","\\x33"}
  4 | {"\\x30","\\x31","\\x32","\\x33","\\x34"}
  5 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35"}
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
(10 rows)

SELECT t, v FROM test_bytea WHERE v =  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                              v                                              
----+---------------------------------------------------------------------------------------------
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
(1 row)

SET anyarray.similarity_type=cosine;
SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                                  v                                                  
----+-----------------------------------------------------------------------------------------------------
  3 | {"\\x30","\\x31","\\x32","\\x33"}
  4 | {"\\x30","\\x31","\\x32","\\x33","\\x34"}
  5 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35"}
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
 11 | {"\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131"}
 12 | {"\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132"}
 13 | {"\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133"}
 14 | {"\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134"}
(12 rows)

SET anyarray.similarity_type=jaccard;
SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                                v                                                
----+-------------------------------------------------------------------------------------------------
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
 11 | {"\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131"}
 12 | {"\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132"}
(7 rows)

SET anyarray.similarity_type=overlap;
SET anyarray.similarity_threshold = 3;
SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                                      v                                                      
----+-------------------------------------------------------------------------------------------------------------
  2 | {"\\x30","\\x31","\\x32"}
  3 | {"\\x30","\\x31","\\x32","\\x33"}
  4 | {"\\x30","\\x31","\\x32","\\x33","\\x34"}
  5 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35"}
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
 11 | {"\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131"}
 12 | {"\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132"}
 13 | {"\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133"}
 14 | {"\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134"}
 15 | {"\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135"}
 16 | {"\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135","\\x3136"}
 17 | {"\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135","\\x3136","\\x3137"}
 18 | {"\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135","\\x3136","\\x3137","\\x3138"}
(17 rows)

RESET anyarray.similarity_threshold;
CREATE INDEX idx_test_bytea ON test_bytea USING gist (v _bytea_aa_ops);
SET enable_seqscan=off;
EXPLAIN (COSTS OFF) SELECT t, v FROM test_bytea WHERE v && '{43,50}' ORDER BY t;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_bytea
         Recheck Cond: (v && '{"\\\\x3433","\\\\x3530"}'::bytea[])
         ->  Bitmap Index Scan on idx_test_bytea
               Index Cond: (v && '{"\\\\x3433","\\\\x3530"}'::bytea[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_bytea WHERE v @> '{43,50}' ORDER BY t;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_bytea on test_bytea
         Index Cond: (v @> '{"\\\\x3433","\\\\x3530"}'::bytea[])
(4 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_bytea WHERE v <@ '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
                                                                       QUERY PLAN                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_bytea on test_bytea
         Index Cond: (v <@ '{"\\\\x30","\\\\x31","\\\\x32","\\\\x33","\\\\x34","\\\\x35","\\\\x36","\\\\x37","\\\\x38","\\\\x39","\\\\x3130"}'::bytea[])
(4 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_bytea WHERE v =  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_bytea on test_bytea
         Index Cond: (v = '{"\\\\x30","\\\\x31","\\\\x32","\\\\x33","\\\\x34","\\\\x35","\\\\x36","\\\\x37","\\\\x38","\\\\x39","\\\\x3130"}'::bytea[])
(4 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Index Scan using idx_test_bytea on test_bytea
         Index Cond: (v % '{"\\\\x30","\\\\x31","\\\\x32","\\\\x33","\\\\x34","\\\\x35","\\\\x36","\\\\x37","\\\\x38","\\\\x39","\\\\x3130"}'::bytea[])
(4 rows)

SELECT t, v FROM test_bytea WHERE v && '{43,50}' ORDER BY t;
 t  |                                                        v                                                        
----+-----------------------------------------------------------------------------------------------------------------
 43 | {"\\x3333","\\x3334","\\x3335","\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433"}
 44 | {"\\x3334","\\x3335","\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434"}
 45 | {"\\x3335","\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435"}
 46 | {"\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436"}
 47 | {"\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437"}
 48 | {"\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438"}
 49 | {"\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439"}
 50 | {"\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530"}
 51 | {"\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531"}
 52 | {"\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532"}
 53 | {"\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533"}
 54 | {"\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534"}
 55 | {"\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535"}
 56 | {"\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536"}
 57 | {"\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537"}
 58 | {"\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537","\\x3538"}
 59 | {"\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537","\\x3538","\\x3539"}
 60 | {"\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537","\\x3538","\\x3539","\\x3630"}
(18 rows)

SELECT t, v FROM test_bytea WHERE v @> '{43,50}' ORDER BY t;
 t  |                                                        v                                                        
----+-----------------------------------------------------------------------------------------------------------------
 50 | {"\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530"}
 51 | {"\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531"}
 52 | {"\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532"}
 53 | {"\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533"}
(4 rows)

SELECT t, v FROM test_bytea WHERE v <@ '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                              v                                              
----+---------------------------------------------------------------------------------------------
  1 | {"\\x30","\\x31"}
  2 | {"\\x30","\\x31","\\x32"}
  3 | {"\\x30","\\x31","\\x32","\\x33"}
  4 | {"\\x30","\\x31","\\x32","\\x33","\\x34"}
  5 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35"}
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
(10 rows)

SELECT t, v FROM test_bytea WHERE v =  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                              v                                              
----+---------------------------------------------------------------------------------------------
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
(1 row)

SET anyarray.similarity_type=cosine;
SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                                  v                                                  
----+-----------------------------------------------------------------------------------------------------
  3 | {"\\x30","\\x31","\\x32","\\x33"}
  4 | {"\\x30","\\x31","\\x32","\\x33","\\x34"}
  5 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35"}
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
 11 | {"\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131"}
 12 | {"\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132"}
 13 | {"\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133"}
 14 | {"\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134"}
(12 rows)

SET anyarray.similarity_type=jaccard;
SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                                v                                                
----+-------------------------------------------------------------------------------------------------
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
 11 | {"\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131"}
 12 | {"\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132"}
(7 rows)

SET anyarray.similarity_type=overlap;
SET anyarray.similarity_threshold = 3;
SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                                      v                                                      
----+-------------------------------------------------------------------------------------------------------------
  2 | {"\\x30","\\x31","\\x32"}
  3 | {"\\x30","\\x31","\\x32","\\x33"}
  4 | {"\\x30","\\x31","\\x32","\\x33","\\x34"}
  5 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35"}
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
 11 | {"\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131"}
 12 | {"\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132"}
 13 | {"\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133"}
 14 | {"\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134"}
 15 | {"\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135"}
 16 | {"\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135","\\x3136"}
 17 | {"\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135","\\x3136","\\x3137"}
 18 | {"\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135","\\x3136","\\x3137","\\x3138"}
(17 rows)

RESET anyarray.similarity_threshold;
DROP INDEX idx_test_bytea;
CREATE INDEX idx_test_bytea ON test_bytea USING gin (v _bytea_aa_ops);
SET enable_seqscan=off;
EXPLAIN (COSTS OFF) SELECT t, v FROM test_bytea WHERE v && '{43,50}' ORDER BY t;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_bytea
         Recheck Cond: (v && '{"\\\\x3433","\\\\x3530"}'::bytea[])
         ->  Bitmap Index Scan on idx_test_bytea
               Index Cond: (v && '{"\\\\x3433","\\\\x3530"}'::bytea[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_bytea WHERE v @> '{43,50}' ORDER BY t;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_bytea
         Recheck Cond: (v @> '{"\\\\x3433","\\\\x3530"}'::bytea[])
         ->  Bitmap Index Scan on idx_test_bytea
               Index Cond: (v @> '{"\\\\x3433","\\\\x3530"}'::bytea[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_bytea WHERE v <@ '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_bytea
         Recheck Cond: (v <@ '{"\\\\x30","\\\\x31","\\\\x32","\\\\x33","\\\\x34","\\\\x35","\\\\x36","\\\\x37","\\\\x38","\\\\x39","\\\\x3130"}'::bytea[])
         ->  Bitmap Index Scan on idx_test_bytea
               Index Cond: (v <@ '{"\\\\x30","\\\\x31","\\\\x32","\\\\x33","\\\\x34","\\\\x35","\\\\x36","\\\\x37","\\\\x38","\\\\x39","\\\\x3130"}'::bytea[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_bytea WHERE v =  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_bytea
         Recheck Cond: (v = '{"\\\\x30","\\\\x31","\\\\x32","\\\\x33","\\\\x34","\\\\x35","\\\\x36","\\\\x37","\\\\x38","\\\\x39","\\\\x3130"}'::bytea[])
         ->  Bitmap Index Scan on idx_test_bytea
               Index Cond: (v = '{"\\\\x30","\\\\x31","\\\\x32","\\\\x33","\\\\x34","\\\\x35","\\\\x36","\\\\x37","\\\\x38","\\\\x39","\\\\x3130"}'::bytea[])
(6 rows)

EXPLAIN (COSTS OFF) SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t
   ->  Bitmap Heap Scan on test_bytea
         Recheck Cond: (v % '{"\\\\x30","\\\\x31","\\\\x32","\\\\x33","\\\\x34","\\\\x35","\\\\x36","\\\\x37","\\\\x38","\\\\x39","\\\\x3130"}'::bytea[])
         ->  Bitmap Index Scan on idx_test_bytea
               Index Cond: (v % '{"\\\\x30","\\\\x31","\\\\x32","\\\\x33","\\\\x34","\\\\x35","\\\\x36","\\\\x37","\\\\x38","\\\\x39","\\\\x3130"}'::bytea[])
(6 rows)

SELECT t, v FROM test_bytea WHERE v && '{43,50}' ORDER BY t;
 t  |                                                        v                                                        
----+-----------------------------------------------------------------------------------------------------------------
 43 | {"\\x3333","\\x3334","\\x3335","\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433"}
 44 | {"\\x3334","\\x3335","\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434"}
 45 | {"\\x3335","\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435"}
 46 | {"\\x3336","\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436"}
 47 | {"\\x3337","\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437"}
 48 | {"\\x3338","\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438"}
 49 | {"\\x3339","\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439"}
 50 | {"\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530"}
 51 | {"\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531"}
 52 | {"\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532"}
 53 | {"\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533"}
 54 | {"\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534"}
 55 | {"\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535"}
 56 | {"\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536"}
 57 | {"\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537"}
 58 | {"\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537","\\x3538"}
 59 | {"\\x3439","\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537","\\x3538","\\x3539"}
 60 | {"\\x3530","\\x3531","\\x3532","\\x3533","\\x3534","\\x3535","\\x3536","\\x3537","\\x3538","\\x3539","\\x3630"}
(18 rows)

SELECT t, v FROM test_bytea WHERE v @> '{43,50}' ORDER BY t;
 t  |                                                        v                                                        
----+-----------------------------------------------------------------------------------------------------------------
 50 | {"\\x3430","\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530"}
 51 | {"\\x3431","\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531"}
 52 | {"\\x3432","\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532"}
 53 | {"\\x3433","\\x3434","\\x3435","\\x3436","\\x3437","\\x3438","\\x3439","\\x3530","\\x3531","\\x3532","\\x3533"}
(4 rows)

SELECT t, v FROM test_bytea WHERE v <@ '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                              v                                              
----+---------------------------------------------------------------------------------------------
  1 | {"\\x30","\\x31"}
  2 | {"\\x30","\\x31","\\x32"}
  3 | {"\\x30","\\x31","\\x32","\\x33"}
  4 | {"\\x30","\\x31","\\x32","\\x33","\\x34"}
  5 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35"}
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
(10 rows)

SELECT t, v FROM test_bytea WHERE v =  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                              v                                              
----+---------------------------------------------------------------------------------------------
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
(1 row)

SET anyarray.similarity_type=cosine;
SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                                  v                                                  
----+-----------------------------------------------------------------------------------------------------
  3 | {"\\x30","\\x31","\\x32","\\x33"}
  4 | {"\\x30","\\x31","\\x32","\\x33","\\x34"}
  5 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35"}
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
 11 | {"\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131"}
 12 | {"\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132"}
 13 | {"\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133"}
 14 | {"\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134"}
(12 rows)

SET anyarray.similarity_type=jaccard;
SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                                v                                                
----+-------------------------------------------------------------------------------------------------
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
 11 | {"\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131"}
 12 | {"\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132"}
(7 rows)

SET anyarray.similarity_type=overlap;
SET anyarray.similarity_threshold = 3;
SELECT t, v FROM test_bytea WHERE v %  '{0,1,2,3,4,5,6,7,8,9,10}' ORDER BY t;
 t  |                                                      v                                                      
----+-------------------------------------------------------------------------------------------------------------
  2 | {"\\x30","\\x31","\\x32"}
  3 | {"\\x30","\\x31","\\x32","\\x33"}
  4 | {"\\x30","\\x31","\\x32","\\x33","\\x34"}
  5 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35"}
  6 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36"}
  7 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37"}
  8 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38"}
  9 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39"}
 10 | {"\\x30","\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130"}
 11 | {"\\x31","\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131"}
 12 | {"\\x32","\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132"}
 13 | {"\\x33","\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133"}
 14 | {"\\x34","\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134"}
 15 | {"\\x35","\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135"}
 16 | {"\\x36","\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135","\\x3136"}
 17 | {"\\x37","\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135","\\x3136","\\x3137"}
 18 | {"\\x38","\\x39","\\x3130","\\x3131","\\x3132","\\x3133","\\x3134","\\x3135","\\x3136","\\x3137","\\x3138"}
(17 rows)

RESET anyarray.similarity_threshold;
